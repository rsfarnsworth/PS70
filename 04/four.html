<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- UIKit -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.15.22/dist/css/uikit.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.15.22/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.15.22/dist/js/uikit-icons.min.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">

    <title>Week 4</title>

    <link rel="stylesheet" href="../styles/fonts.css">
    <link rel="stylesheet" href="../styles/main.css">

    <link rel="icon" href="../../resources/icons/ps70_icon.svg">
</head>

<body>
    <nav class="uk-navbar uk-navbar-container uk-navbar-transparent uk-margin" uk-navbar>
        <div class="uk-navbar-left uk-margin-medium-left">
            <a class="uk-navbar-item uk-logo" href="https://bellatarantino.com/ps70/">PS 70</a>
        </div>
        <div class="uk-navbar-right uk-margin-medium-right">
            <a class="uk-navbar-toggle uk-navbar-toggle-animate" uk-navbar-toggle-icon href="#"></a>
            <div class="uk-navbar-dropdown">
                <ul class="uk-nav uk-navbar-dropdown-nav">
                    <li><a href="https://rsfarnsworth.github.io/PS70//about.html">About</a></li>
                    <li><a href="https://rsfarnsworth.github.io/PS70//assignments.html">Assignments</a></li>
                    <li><a href="https://rsfarnsworth.github.io/PS70//.html">Final Project</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="uk-container">
        <div class="uk-text-center">
            <h1 class="uk-margin-medium-top assignment-title">Week 4</h1>
            <h3 class="assignment-subtitle">microcontroller programming</h3>
        </div>

        <div class="uk-container-small uk-margin-large-top uk-margin-auto">
            <div uk-grid>
                <div class="uk-grid-item-match uk-width-1-3@s">
                    <div>
                        <h3>Assignment Prompt</h3>
                    </div>
                </div>
                <div class="uk-width-2-3@s">

                    <div class="uk-text-left">
                        <p>
                            Program an Arduino board to do something.
                        </p>
                    </div>

                </div>
            </div>

            <div uk-grid>
                <div class="uk-grid-item-match uk-width-1-3@s">
                    <div>
                        <h3>Process</h3>
                    </div>
                </div>
                <div class="uk-width-2-3@s">

                    <div class="uk-text-left">
                        <p>
                            I'm getting more worried about the final project, but apparently I'm not going to do something useful
                            for that this week either. I'm going to try and code the arduino such that the motor speed of my 
                            sculpture is determined by the length of time I've held down the button. Longer button press should 
                            mean a slower speed with the motor. I spent an embarrasing 
                            amount of time trying to code this. I initially tried using classes but got really confused at the 
                            uses of this and what the update function does in a class. Thomas helped me a lot with this and 
                            gave me a good explanation of 1. millis, 2. object oriented programming, 3. the update function in 
                            a class. I spent a lot of time talking with Chris and Bobby as well. As it stands the arduino code 
                            does what I want it to do. But it ALSO changes speed while I'm holding the button. I will come back 
                            and fix this at a later point although I don't think it will be that difficult to fix, I just ran 
                            out of time. 
                            <br>
                            <br>
                            I also know it is hard to tell when I am and when I'm not pressing the button in this video, but 
                            it does demonstrate the functionality of the button controlling the speed of the drummer to some 
                            extent. I'll draw this schematic once I catch up... sorry y'all.
                            <video width="530" height="350" controls>
                                <source src="video.MOV" type="video/mp4">
                            </video>
                            <br>
                            <br>
                        </p>
                    </div>

                </div>
            </div>

            <div uk-grid>
                <div class="uk-grid-item-match uk-width-1-3@s">
                    <div>
                        <h3>code</h3>
                    </div>
                </div>
                <div class="uk-width-2-3@s">

                    <div class="uk-text-left">
                        <p>

                        <pre><code>
int buttonpin = 3;
int motorpin = 11;
int current_state;
int previous_state=HIGH;
int i_time=millis();
int f_time=millis();
int time_dif;


void setup() {
  // put your setup code here, to run once:
  pinMode(motorpin, OUTPUT);
  pinMode(buttonpin, INPUT_PULLUP);
  Serial.begin(9600);
}

void loop() {
  // put your main code here, to run repeatedly:

  current_state = digitalRead(buttonpin);

  if (current_state == LOW) {
    if (previous_state == HIGH) {
      f_time = millis();
    }
  }

  if (current_state == HIGH) {
    if (previous_state == LOW) {
      i_time = millis();
    }
  }
  
  time_dif = abs(f_time - i_time);
  //Serial.println(time_dif);
  previous_state = current_state;

  int motor_val = map(time_dif, 0, 5000, 75, 255);
  Serial.println(motor_val);
  analogWrite(motorpin, motor_val);

}

</code></pre>
<br>
                            <br>
                            I was able to update this shortly before class on thursday with the help of Nathan. 
                            <pre><code>
int buttonpin = 3;
int motorpin = 11;
int current_state;
int previous_state=HIGH;
int i_time=millis();
int f_time=millis();
int time_dif;


void setup() {
  // put your setup code here, to run once:
  pinMode(motorpin, OUTPUT);
  pinMode(buttonpin, INPUT_PULLUP);
  Serial.begin(9600);
}

void loop() {
  // put your main code here, to run repeatedly:

  current_state = digitalRead(buttonpin);
  
  if (current_state == LOW) {
    if (previous_state == HIGH) {
      i_time = millis();
      previous_state = current_state;
    }
  }

  if (current_state == HIGH) {
    if (previous_state == LOW) {
      f_time = millis();
      previous_state = current_state;
      time_dif = abs(f_time - i_time);
    }
  }

  
  Serial.println(time_dif);

  int motor_val = map(time_dif, 0, 5000, 60, 220);

  //Serial.println(motor_val);
  analogWrite(motorpin, motor_val);

}

                                
                                </code></pre>

                        
                    </div>

                </div>
            </div>

        </div>
    </div>
</body>

</html>